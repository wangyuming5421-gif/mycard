<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¡ç‰Œè¿›è´§è®°è´¦</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        body { -webkit-tap-highlight-color: transparent; font-family: -apple-system, sans-serif; }
        .card-shadow { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="app" class="max-w-md mx-auto p-4">
        <h1 class="text-xl font-bold mb-4 text-gray-800 flex items-center">ğŸ“¦ å¡ç‰Œè¿›è´§åŠ©æ‰‹</h1>
        
        <div class="bg-white p-5 rounded-2xl card-shadow mb-6">
            <div class="space-y-4">
                <div>
                    <label class="block text-xs text-gray-500 mb-1">è¿›è´§ç±»å‹</label>
                    <select v-model="form.type" class="w-full p-3 bg-gray-100 rounded-xl border-none focus:ring-2 focus:ring-blue-500">
                        <option value="single">å•å¼ å¡ (æ•£æ”¶)</option>
                        <option value="box">æ•´ç›’å¡ (åŸç®±/æ•£ç›’)</option>
                        <option value="sleeve">é…ä»¶ (å¡å¥—ç­‰)</option>
                    </select>
                </div>

                <div v-if="form.type === 'single'">
                    <label class="block text-xs text-gray-500 mb-1">æ¥æºåœ°</label>
                    <div class="grid grid-cols-2 gap-2">
                        <button @click="form.source = 'shapingba'" :class="form.source === 'shapingba' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-600'" class="p-2 rounded-lg text-sm transition">æ²™åªå(6å…ƒ)</button>
                        <button @click="form.source = 'yubei'" :class="form.source === 'yubei' ? 'bg-blue-600 text-white' : 'bg-gray-100 text-gray-600'" class="p-2 rounded-lg text-sm transition">æ¸åŒ—(7å…ƒ+11)</button>
                    </div>
                </div>

                <div v-if="form.type === 'box'">
                    <label class="block text-xs text-gray-500 mb-1">ç›’å­æ¡£ä½</label>
                    <select v-model="form.boxType" class="w-full p-3 bg-gray-100 rounded-xl border-none">
                        <option value="165">æ™®é€šå¡ (165å…ƒ/ç›’)</option>
                        <option value="200">å¥½å¡ (200å…ƒ/ç›’)</option>
                        <option value="120">å¤„ç†å¡ (120å…ƒ/ç›’)</option>
                    </select>
                </div>

                <div>
                    <label class="block text-xs text-gray-500 mb-1">è¿›è´§æ•°é‡</label>
                    <input type="number" v-model.number="form.count" class="w-full p-3 bg-gray-100 rounded-xl border-none" placeholder="è¾“å…¥æ•°é‡">
                </div>

                <button @click="addItem" class="w-full bg-blue-600 text-white py-4 rounded-2xl font-bold active:scale-95 transition shadow-lg shadow-blue-200">
                    ç¡®è®¤æ·»åŠ è®°å½•
                </button>
            </div>
        </div>

        <div class="grid grid-cols-2 gap-3 mb-6">
            <div class="bg-blue-600 p-4 rounded-2xl text-white shadow-lg">
                <p class="text-xs opacity-80">æœ¬æœˆæ€»æ”¯å‡º</p>
                <p class="text-xl font-bold">Â¥ {{ totalCost }}</p>
            </div>
            <div class="bg-white p-4 rounded-2xl border border-gray-100 card-shadow text-center">
                <p class="text-xs text-gray-400">ç´¯è®¡å•æ•°</p>
                <p class="text-xl font-bold text-gray-700">{{ logs.length }}</p>
            </div>
        </div>

        <div class="space-y-3">
            <h2 class="text-sm font-bold text-gray-400 px-1">å†å²è´¦å• (æœ€è¿‘)</h2>
            <div v-for="(log, index) in logs" :key="index" class="bg-white p-4 rounded-xl flex justify-between items-center card-shadow border-l-4 border-blue-500">
                <div>
                    <p class="font-bold text-gray-800 text-sm">{{ log.desc }}</p>
                    <p class="text-xs text-gray-400">{{ log.date }}</p>
                </div>
                <div class="text-right">
                    <p class="text-orange-500 font-bold">Â¥{{ log.cost }}</p>
                    <button @click="remove(index)" class="text-xs text-red-300">åˆ é™¤</button>
                </div>
            </div>
        </div>
        
        <div class="mt-10 text-center">
            <button @click="clearAll" class="text-xs text-gray-300 underline">æ¸…ç©ºæ‰€æœ‰æ•°æ®</button>
        </div>
    </div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue
        createApp({
            setup() {
                const logs = ref([])
                const form = ref({ type: 'single', source: 'shapingba', boxType: '165', count: 1 })

                onMounted(() => {
                    const saved = localStorage.getItem('card_inventory_logs')
                    if (saved) logs.value = JSON.parse(saved)
                })

                const addItem = () => {
                    if (!form.value.count || form.value.count <= 0) return alert('è¯·è¾“å…¥æ•°é‡');
                    let cost = 0; let desc = '';
                    const date = new Date();
                    const dateStr = `${date.getMonth()+1}/${date.getDate()} ${date.getHours()}:${date.getMinutes()}`;

                    if (form.value.type === 'single') {
                        if (form.value.source === 'shapingba') {
                            cost = form.value.count * 6;
                            desc = `æ²™åªåå•å¡ x${form.value.count}`;
                        } else {
                            cost = (form.value.count * 7) + 11;
                            desc = `æ¸åŒ—å•å¡ x${form.value.count} (å«11è¿è´¹)`;
                        }
                    } else if (form.value.type === 'box') {
                        cost = form.value.count * parseInt(form.value.boxType);
                        let name = form.value.boxType == '165' ? 'æ™®é€š' : (form.value.boxType == '200' ? 'å¥½å¡' : 'å¤„ç†');
                        desc = `${name}æ•´ç›’ x${form.value.count}`;
                    } else {
                        cost = form.value.count * 20;
                        desc = `å¡å¥—é…ä»¶ x${form.value.count}`;
                    }

                    logs.value.unshift({ date: dateStr, desc, cost });
                    save();
                }

                const save = () => localStorage.setItem('card_inventory_logs', JSON.stringify(logs.value))
                const totalCost = computed(() => logs.value.reduce((sum, item) => sum + item.cost, 0))
                const remove = (i) => { if(confirm('ç¡®å®šåˆ é™¤å—ï¼Ÿ')){ logs.value.splice(i, 1); save(); } }
                const clearAll = () => { if(confirm('è­¦å‘Šï¼šå°†æ¸…ç©ºæ‰€æœ‰è®°è´¦è®°å½•ï¼')){ logs.value = []; save(); } }

                return { form, logs, addItem, totalCost, remove, clearAll }
            }
        }).mount('#app')
    </script>
</body>

</html>
